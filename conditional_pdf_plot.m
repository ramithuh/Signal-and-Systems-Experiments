function g = conditional_pdf_plot(R,alpha,N1,I1,pulses,A,disp_n,variance,bins)inter="yes"if(sum(I1)==0)  inter="no"endclose all;figure(15,"position",get(0,"screensize"))subplot(4,3,1:3)stairs(pulses(1:2*disp_n),'LineStyle','-','color','b');title(['A sample of the Transmitted Sequence (S);  A=',num2str(A)],'LineStyle','-','color','b')axis([0 inf -2*A 2*A])subplot(4,3,4:5)stairs(N1(1:2*disp_n),'LineStyle','-','color','r');title(['A sample of the Noise; AWGN-Variance=',num2str(variance)],'LineStyle','-','color','r')axis auto;subplot(4,3,6)stairs(I1(1:2*disp_n),'LineStyle','-','color','k');title(['A sample of the Interference'],'LineStyle','-','color','k')axis auto;subplot(4,3,7:9)stairs(R(1:2*disp_n),'LineStyle','-','color','m');title(['A sample of the Received Sequence (R=alpha*S+N+I); alpha= ',num2str(alpha)],'LineStyle','-','color','m')axis auto;subplot(4,3,10)[f,x]=hist(R,bins);bar(x, f / sum(f));title(['PDF of R; E[R]= ',num2str(mean(R))]);hold on;line([0, 0], ylim, 'LineWidth', 2, 'Color', 'r');subplot(4,3,11)pdf_A1=conditional_pdf(R,pulses,A);[f,x]=hist(pdf_A1,bins);bar(x, f / sum(f));title(['PDF of R given that S=A;  E[R|S=A]= ',num2str(mean(pdf_A1))]);hold on;line([0, 0], ylim, 'LineWidth', 2, 'Color', 'r');subplot(4,3,12)pdf_A2=conditional_pdf(R,pulses,-A);[f,x]=hist(pdf_A2,bins);bar(x, f / sum(f));title(['PDF of R given that S=-A ;  E[R|S=-A]= ',num2str(mean(pdf_A2))]);hold on;line([0, 0], ylim, 'LineWidth', 2, 'Color', 'r');name=strcat("Summary_A=",num2str(A),"_Var=",num2str(variance),"_alpha=",num2str(alpha),"_Interference=",inter,".eps")print (15,name, "-depsc","-S1180,720","-F:8")end